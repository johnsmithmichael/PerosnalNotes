。## 什么是 Lambda 表达式？
Lambda 表达式是一种​**​匿名函数​**​（即没有名称的函数），它允许你快速定义简单的函数逻辑，通常用于需要临时、简短函数的场景，避免了使用正式函数定义（如 `def`或 `function`）的语法开销。其核心思想源于数学中的 λ 演算
## 基本语法格式
虽然不同编程语言的 Lambda 表达式语法略有差异，但基本结构相似
 非常通用的形式，并非特定语言
([capture-list]) (parameters) -> return-type { function-body }
**capture-list是捕获列表,捕获列表的作用就是让Lambda表达式能够访问外部作用域中的变量。换句话说，Lambda表达式本身是一个独立的小世界，但它可以通过捕获列表从外面“偷渡”一些变量进来使用。
![[Pasted image 20250901034646.png]]
​**​参数列表 (parameters)​**​: 与普通函数的参数列表一致，如果不需要参数传递，可以省略（但括号可能需保留，取决于语言和参数数量）
​**​返回类型 (return-type)​**​: 在某些语言中可省略，由编译器或解释器自动推导
​**​函数体 (function-body)​**​: 包含 Lambda 表达式的执行代码。通常只能包含一个表达式或语句块（取决于语言
## 不同语言中的 Lambda
1. Python 中的 Lambda
	Python 的 Lambda 表达式非常简洁，==主要用于编写简单的匿名函数==
	​**​语法​**​: `lambda 参数列表: 表达式`
	​**​特点​**​:
	- •函数体只能是一个​**​表达式​**​，不能包含复杂的语句或多条语句（如循环、条件分支等）
	- •不需要 `return` 关键字，表达式的结果自动作为返回值
	- •常用于 `map()`, `filter()`, `sorted()` 等高阶函数或作为回调函数
	![[Pasted image 20250901035305.png]]
2. Java 中的 Lambda
	java 8 引入了 Lambda 表达式，主==要用于简化函数式接口（只有一个抽象方法的接口）的实现==
	- ​**​语法​**​: `(参数列表) -> { 函数体 }`或 `(参数列表) -> 表达式`（单表达式时可省略大括号和 return）
    ​**​特点​**​:
    依赖于​**​函数式接口​**​（如 `Consumer<T>`, `Function<T,R>`, `Predicate<T>`）
        大幅简化了匿名内部类的写法
         支持类型推断，参数类型常可省略
        ![[Pasted image 20250902014303.png]]
3. C++ 中的 Lambda
	C++11 引入了 Lambda 表达式，功能非常强大，包括捕获列表等独特特性
	**语法​**​: `[捕获列表](参数列表) -> 返回类型 { 函数体 }`（返回类型和参数列表在特定情况下可省略
	`[=]`：以值方式捕获所有外部变量。
    `[&]`：以引用方式捕获所有外部变量。
    `[a, &b]`：以值捕获 a，引用捕获 b。
    `[this]`：捕获当前类的 this 指针。
    可以声明为 `mutable`（允许修改按值捕获的变量）
    可以立即调用（IIFE - Immediately Invoked Function Expression）
    使用讲解：
	    ## 捕获列表的工作原理
			捕获列表的作用就是让Lambda表达式能够访问外部作用域中的变量。换句话说，Lambda表达式本身是一个独立的小世界，但它可以通过捕获列表从外面“偷渡”一些变量进来使用。
			![[Pasted image 20250902014837.png]]
	 不同捕获方式的区别
		捕获列表有多种方式，每种方式都有其独特的用途和行为。下面我们通过几个场景来逐一探讨。
		### 1. **值捕获（Value Capture）**
			值捕获是最常见的方式之一。它将外部变量的值复制到Lambda表达式内部。这种方式的好处是安全且简单，但缺点是如果外部变量发生变化，Lambda表达式内部的副本不会同步更新。
			![[Pasted image 20250902015007.png]]
		### 2. **引用捕获（Reference Capture）**
			引用捕获则是直接将外部变量的引用传递给Lambda表达式。这种方式的优点是Lambda表达式内部的操作会直接影响外部变量，但需要注意的是，如果外部变量在Lambda执行前被销毁，会导致未定义行为。
			![[Pasted image 20250902015226.png]]
		==要注意值捕获和引用捕获的区别==
		### 底层原理浅析值捕获和引用捕获
			编译器处理 Lambda 表达式时，会为其生成一个​独特的匿名类（闭包类型）​​
			捕获的变量会成为这个匿名类的成员变量
				​**​值捕获​**​：相当于这个匿名类中有一个 `int a_copy;`成员，在构造 Lambda 对象时用外部 `a`的值来初始化它
				​**​引用捕获​**​：相当于这个匿名类中有一个 `int& a_ref;`成员，它被绑定到外部的 `a`上
		​**​`mutable`关键字​**​：值捕获的变量默认在 Lambda 内部是只读的。若需修改其​​副本​​，必须在参数列表后加上 `mutable`关键字（它不会影响外部原始变量）
		![[Pasted image 20250902024122.png]]
		### 3.**隐式捕获（Implicit Capture）**
		有时候我们懒得一个个列出要捕获的变量，这时可以使用隐式捕获。隐式捕获分为两种：按值捕获（`[=]`）和按引用捕获（`[&]`）
		- `[=]`：捕获所有外部变量的值。
		- `[&]`：捕获所有外部变量的引用。
			默认捕获的风险​：使用 `[=]`（默认值捕获）或 `[&]`（默认引用捕获）虽方便，但会​​隐式捕获所有当前作用域的变量​，可能导致意外捕获或性能问题​**​建议优先使用显式捕获​**​（明确列出要捕获的变量，如 `[a, &b]`），让意图更清
		![[Pasted image 20250902023622.png]]
		### 4. **混合捕获（Mixed Capture）**
			可以混合使用不同的捕获方式。例如，有些变量按值捕获，有些变量按引用捕获。
			![[Pasted image 20250902023724.png]]
		总结捕获方式对比表
		![[Pasted image 20250902024943.png]]